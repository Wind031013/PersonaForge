# PersonaForge

<div align="center">

![Python](https://img.shields.io/badge/Python-3.12+-blue.svg)
![LangChain](https://img.shields.io/badge/LangChain-orange.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

**æ„å»ºé«˜è´¨é‡å¯¹è¯æ•°æ®é›†çš„è‡ªåŠ¨åŒ–æµæ°´çº¿**

[åŠŸèƒ½ç‰¹è‰²](#-åŠŸèƒ½ç‰¹è‰²) â€¢ [æŠ€æœ¯æ ˆ](#-æŠ€æœ¯æ ˆ) â€¢ [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢ [ä½¿ç”¨ç¤ºä¾‹](#-ä½¿ç”¨ç¤ºä¾‹) â€¢ [é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä¸“ä¸ºæ„å»ºé«˜è´¨é‡è§’è‰²å¯¹è¯æ•°æ®é›†è®¾è®¡çš„è‡ªåŠ¨åŒ–æµæ°´çº¿ï¼Œä¸“æ³¨äºä»ä¸­å›½å¤å…¸åè‘—ã€Šè¥¿æ¸¸è®°ã€‹ä¸­æå–ã€æ¸…æ´—å’Œé‡æ„å­™æ‚Ÿç©ºçš„ç»å…¸å°è¯ã€‚é€šè¿‡ç»“åˆç°ä»£ LLM æŠ€æœ¯å’Œæ™ºèƒ½è¿‡æ»¤ç®—æ³•ï¼Œç”Ÿæˆé€‚åˆå¤§æ¨¡å‹å¾®è°ƒçš„é«˜è´¨é‡å¯¹è¯æ•°æ®ã€‚

### ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜

- **æ•°æ®ç¨€ç¼º**ï¼šç¼ºä¹å…·æœ‰é²œæ˜è§’è‰²ç‰¹å¾çš„é«˜è´¨é‡å¯¹è¯è®­ç»ƒæ•°æ®
- **æˆæœ¬é«˜æ˜‚**ï¼šäººå·¥æ ‡æ³¨å’Œç­›é€‰å¯¹è¯æ•°æ®è´¹æ—¶è´¹åŠ›
- **è´¨é‡å‚å·®**ï¼šåŸå§‹æ–‡æœ¬ä¸­æ··å…¥å¤§é‡æ— å…³å†…å®¹å’Œä½è´¨é‡å¯¹è¯

---

## âœ¨ åŠŸèƒ½ç‰¹è‰²

### ğŸ” æ™ºèƒ½çˆ¬å–
- ğŸ“– è‡ªåŠ¨ä¸‹è½½ã€Šè¥¿æ¸¸è®°ã€‹å…¨ç« èŠ‚å†…å®¹
- ğŸ”„ å¸¦é‡è¯•æœºåˆ¶çš„å¥å£®ç½‘ç»œè¯·æ±‚
- â±ï¸ æ™ºèƒ½é™é€Ÿï¼Œå°Šé‡ç›®æ ‡ç½‘ç«™

### ğŸ¤– AI é©±åŠ¨çš„å¯¹è¯æå–
- ğŸ¯ åŸºäºæ™ºè°± AI GLM-4.5-Air æ¨¡å‹
- ğŸ·ï¸ è¯†åˆ«å­™æ‚Ÿç©ºåŠå…¶å¤šä¸ªåˆ«åï¼ˆçŸ³çŒ´ã€ç¾çŒ´ç‹ã€çŒ´ç‹ã€å¤§åœ£ï¼‰
- âœ¨ ç²¾ç¡®æå–å¼•å·å†…å¯¹è¯åŸæ–‡ï¼Œæ’é™¤æ—ç™½

### ğŸ­ å¤šç»´åº¦æ€§æ ¼è¿‡æ»¤
- ğŸ¦¾ **æ¡€éªœä¸éœ¸æ°”** - ä½“ç°å¨ä¸¥ã€è‡ªä¿¡ã€ä¸ç•å¼ºæƒ
- ğŸ˜ **å¹½é»˜ä¸å˜²è®½** - æœºæ™ºçš„è°ƒä¾ƒã€ç‰¹æœ‰çš„å£ç™–
- ğŸ’ **æƒ…ä¹‰ä¸è´£ä»»** - å¯¹å”åƒ§çš„æƒ…æ„Ÿã€å¯¹çŒ´å­™çš„æŠ¤çŸ­
- ğŸ”¥ **æ ‡å¿—æ€§è¯æ±‡** - "ä¿ºè€å­™"ã€"è€å­™"ã€"å¤§åœ£"

### ğŸ”„ æ™ºèƒ½å¯¹è¯é‡æ„
- ğŸª æ¯å¥å°è¯ç”Ÿæˆ 2 ä¸ªä¸åŒçš„å¯¹è¯åœºæ™¯
- ğŸ’¬ æ„å»º (Scene, Input, Output) å®Œæ•´ç»“æ„
- ğŸš€ å¼‚æ­¥æ‰¹é‡å¤„ç†ï¼Œæ”¯æŒé«˜å¹¶å‘

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| **è¯­è¨€** | Python 3.12+ | ç°ä»£ Python ç‰ˆæœ¬ï¼Œæ€§èƒ½ä¼˜å¼‚ |
| **LLM æ¡†æ¶** | LangChain | å¤§è¯­è¨€æ¨¡å‹åº”ç”¨å¼€å‘æ¡†æ¶ |
| **AI æ¨¡å‹** | æ™ºè°± AI GLM-4.5-Air | ä¸­æ–‡ç†è§£èƒ½åŠ›å¼ºï¼Œè´¨é‡é«˜ |
| **æ•°æ®éªŒè¯** | Pydantic | ç±»å‹å®‰å…¨çš„æ•°æ®éªŒè¯å’Œåºåˆ—åŒ– |
| **HTTP å®¢æˆ·ç«¯** | requests + httpx | å¥å£®çš„ç½‘ç»œè¯·æ±‚æ”¯æŒ |
| **HTML è§£æ** | BeautifulSoup4 | é«˜æ•ˆçš„ç½‘é¡µå†…å®¹è§£æ |
| **å¼‚æ­¥å¤„ç†** | asyncio + aiofiles | é«˜æ€§èƒ½å¼‚æ­¥æ–‡ä»¶æ“ä½œ |
| **é‡è¯•æœºåˆ¶** | tenacity | ä¼˜é›…çš„é”™è¯¯é‡è¯•å¤„ç† |
| **è¿›åº¦å±•ç¤º** | tqdm | å‹å¥½çš„è¿›åº¦æ¡æ˜¾ç¤º |

### æ ¸å¿ƒä¾èµ–

```toml
# pyproject.toml
dependencies = [
    "aiofiles>=25.1.0",        # å¼‚æ­¥æ–‡ä»¶æ“ä½œ
    "httpx>=0.28.1",         # HTTP å®¢æˆ·ç«¯
    "langchain>=1.2.3",      # LLM æ¡†æ¶
    "langchain-community>=0.4.1",
    "langchain-openai>=1.1.7",
    "openai>=2.15.0",        # OpenAI API
    "pandas>=2.3.3",         # æ•°æ®å¤„ç†
    "requests>=2.32.5",     # HTTP è¯·æ±‚
    "tenacity>=9.1.2",       # é‡è¯•æœºåˆ¶
    "tqdm>=4.67.1",          # è¿›åº¦æ¡
]
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd sun-wukong-dataset

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
source .venv/bin/activate  # Linux/Mac
.venv\Scripts\activate     # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
# æˆ–ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
uv pip install -r requirements.txt
```

### é…ç½® API å¯†é’¥

åœ¨ä½¿ç”¨å‰ï¼Œè¯·ç¡®ä¿å·²é…ç½®æ™ºè°± AI API å¯†é’¥ï¼š

```bash
# åœ¨ç»ˆç«¯è®¾ç½®ç¯å¢ƒå˜é‡
export ZHIPUAI_API_KEY="your-api-key-here"

# æˆ–è€…åœ¨ä»£ç ä¸­ç›´æ¥è®¾ç½®
import os
os.environ["ZHIPUAI_API_KEY"] = "your-api-key-here"
```

### è¿è¡Œæµç¨‹

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯åˆ†æ­¥è¿è¡Œï¼š

```python
# 1. çˆ¬å–ã€Šè¥¿æ¸¸è®°ã€‹ç« èŠ‚
from crawler import download_all_chapters
await download_all_chapters()

# 2. æå–å¯¹è¯
from extract import extract_dialogues
await extract_dialogues()

# 3. è¿‡æ»¤å¯¹è¯
from filter import filter_dialogues
await filter_dialogues()

# 4. é‡æ„å¯¹è¯
from Reconstruct import reconstruct_dialogues
await reconstruct_dialogues()
```

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### æå–å­™æ‚Ÿç©ºå¯¹è¯

```python
from extract import extract_dialogues

# ä»çˆ¬å–çš„æ–‡æœ¬ä¸­æå–å¯¹è¯
dialogues = await extract_dialogues()

# è¾“å‡ºæ ¼å¼ç¤ºä¾‹
print(dialogues[0])
# {
#     "character": "å­™æ‚Ÿç©º",
#     "alias": "ç¾çŒ´ç‹",
#     "dialogue": "ä¿ºè€å­™è‡ªå‡ºå¨˜èƒï¼Œå°±åšè¿™ä¸ªå‹¾å½“ï¼",
#     "chapter": "ç¬¬ä¸€å›"
# }
```

### æ€§æ ¼ç»´åº¦è¿‡æ»¤

```python
from filter import filter_dialogues

# åŸºäºæ€§æ ¼ç‰¹å¾è¿‡æ»¤é«˜è´¨é‡å¯¹è¯
filtered = await filter_dialogues()

# è¿‡æ»¤ç»´åº¦ï¼š
# - æ¡€éªœéœ¸æ°”ï¼šä½“ç°å¨ä¸¥ã€è‡ªä¿¡
# - å¹½é»˜å˜²è®½ï¼šæœºæ™ºè°ƒä¾ƒ
# - æƒ…ä¹‰è´£ä»»ï¼šå¯¹å”åƒ§çš„æƒ…æ„Ÿ
# - æ ‡å¿—æ€§è¯æ±‡ï¼šä½¿ç”¨"ä¿ºè€å­™"ç­‰
```

### å¯¹è¯é‡æ„

```python
from Reconstruct import reconstruct_dialogues

# æ„å»ºå®Œæ•´å¯¹è¯æ•°æ®é›†
dataset = await reconstruct_dialogues()

# è¾“å‡ºæ ¼å¼ï¼š
# {
#     "scene": "åœºæ™¯æè¿°",
#     "input": "ç”¨æˆ·è¾“å…¥",
#     "output": "å­™æ‚Ÿç©ºå›å¤"
# }
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
sun-wukong-dataset/
â”œâ”€â”€ ğŸ“„ crawler.py              # ç½‘ç»œçˆ¬è™«æ¨¡å—
â”œâ”€â”€ ğŸ“„ extract.py              # å¯¹è¯æå–æ¨¡å—
â”œâ”€â”€ ğŸ“„ filter.py               # å¯¹è¯è¿‡æ»¤æ¨¡å—
â”œâ”€â”€ ğŸ“„ Reconstruct.py          # å¯¹è¯é‡æ„æ¨¡å—
â”œâ”€â”€ ğŸ“„ temp.py                 # ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆæµ‹è¯•ç”¨ï¼‰
â”œâ”€â”€ ğŸ“„ main.py                 # é¡¹ç›®å…¥å£ï¼ˆå¾…å®ç°ï¼‰
â”œâ”€â”€ ğŸ“„ requirements.txt         # ä¾èµ–æ¸…å•
â”œâ”€â”€ ğŸ“„ pyproject.toml          # é¡¹ç›®é…ç½®
â”œâ”€â”€ ğŸ“„ README.md               # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ ğŸ“„ .gitignore              # Git å¿½ç•¥æ–‡ä»¶
```

### æ¨¡å—è¯´æ˜

| æ¨¡å— | åŠŸèƒ½ | ç‰¹ç‚¹ |
|------|------|------|
| **crawler.py** | ç½‘ç»œçˆ¬è™« | è‡ªåŠ¨ä¸‹è½½ç« èŠ‚ã€é‡è¯•æœºåˆ¶ã€æ™ºèƒ½é™é€Ÿ |
| **extract.py** | å¯¹è¯æå– | LLM é©±åŠ¨ã€å¼‚æ­¥å¤„ç†ã€ç»“æ„åŒ–è¾“å‡º |
| **filter.py** | å¯¹è¯è¿‡æ»¤ | å¤šç»´åº¦æ€§æ ¼ç­›é€‰ã€å¹¶å‘å¤„ç†ã€è´¨é‡ä¿è¯ |
| **Reconstruct.py** | å¯¹è¯é‡æ„ | åœºæ™¯æ„å»ºã€æ‰¹é‡å¤„ç†ã€è‡ªåŠ¨é‡è¯• |

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

### å¼€å‘æµç¨‹

1. **Fork é¡¹ç›®**
2. **åˆ›å»ºç‰¹æ€§åˆ†æ”¯** (`git checkout -b feature/AmazingFeature`)
3. **æäº¤æ›´æ”¹** (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€åˆ†æ”¯** (`git push origin feature/AmazingFeature`)
5. **åˆ›å»º Pull Request**

### ä»£ç è§„èŒƒ

- éµå¾ª PEP 8 ç¼–ç è§„èŒƒ
- ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼æé«˜æ€§èƒ½
- æ·»åŠ é€‚å½“çš„ç±»å‹æ³¨è§£
- ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

---

## ğŸ™ è‡´è°¢

- [æ™ºè°± AI](https://open.bigmodel.cn/) - æä¾›å¼ºå¤§çš„ GLM æ¨¡å‹æ”¯æŒ
- [LangChain](https://github.com/langchain-ai/langchain) - ä¼˜ç§€çš„ LLM åº”ç”¨å¼€å‘æ¡†æ¶
- ã€Šè¥¿æ¸¸è®°ã€‹ä½œè€…å´æ‰¿æ© - åˆ›é€ äº†ä¸æœ½çš„ç»å…¸å½¢è±¡

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ç»™ä¸ª starï¼**

[å›åˆ°é¡¶éƒ¨](#-å­™æ‚Ÿç©ºå¯¹è¯æ•°æ®æ„å»ºå·¥å…·)

</div>